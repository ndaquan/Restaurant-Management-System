<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Ch·ªânh s·ª≠a tin t·ª©c</title>
  <link rel="stylesheet" href="/css/editNews.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>
<body>
  <div>
    <header class="news-header">
      <button class="btn-return fas fa-chevron-left fa-lg" onclick="window.location.href='/admin/adminNews'"></button>
      <h1>Ch·ªânh s·ª≠a tin t·ª©c</h1>
    </header>
    <div class="form-wrapper">
      <div class="form-container">
        <div class="image-container">
          <img src="<%= article.image %>" alt="·∫¢nh tin t·ª©c hi·ªán t·∫°i">
        </div>
        <form id="editNewsForm" onsubmit="handleEditNewsFormSubmit(event)">
          <input type="hidden" id="newsId" name="newsId" value="<%= article._id %>">
          <div class="food-form">
            <label for="title">Ti√™u ƒë·ªÅ tin t·ª©c</label>
            <input type="text" id="title" name="title" value="<%= article.title %>" required>
          
            <label for="description">N·ªôi dung</label>
            <textarea id="description" name="content" rows="6" required><%= article.content %></textarea>         
       
            <label for="foodImage">Ch·ªçn ·∫£nh m·ªõi (n·∫øu c√≥)</label>
            <input type="file" id="foodImage" name="image" accept="image/*">
          </div>
          <button type="submit" class="submit-btn">C·∫≠p nh·∫≠t tin t·ª©c</button>
        </form>
      </div>
    </div>
  </div>
  <script>
    async function handleEditNewsFormSubmit(event) {
      event.preventDefault();
      const form = document.getElementById("editNewsForm");
      const formData = new FormData(form);
      const newsId = document.getElementById("newsId").value;
      try {
        const response = await fetch(`/admin/adminNews/${newsId}`, {
          method: "PUT",
          body: formData
        });
        const data = await response.json();
        if (data.success) {
          Swal.fire({
            title: "üéâ C·∫≠p nh·∫≠t th√†nh c√¥ng!",
            text: "Tin t·ª©c ƒë√£ ƒë∆∞·ª£c ch·ªânh s·ª≠a.",
            icon: "success",
            confirmButtonText: "OK",
            background: "#ffffff",
            color: "#333",
            padding: "20px",
            showClass: {
              popup: "animate__animated animate__zoomIn"
            },
            hideClass: {
              popup: "animate__animated animate__fadeOutDown"
            }
          }).then(() => {
            window.location.href = "/admin/adminNews";
          });
        } else {
          Swal.fire({
            title: "L·ªói!",
            text: data.message,
            icon: "error",
            confirmButtonText: "Th·ª≠ l·∫°i"
          });
        }
      } catch (error) {
        Swal.fire({
          title: "L·ªói!",
          text: "C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t tin t·ª©c.",
          icon: "error",
          confirmButtonText: "Th·ª≠ l·∫°i"
        });
      }
    }
  </script>
</body>
</html>
