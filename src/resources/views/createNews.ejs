<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>T·∫°o b√†i vi·∫øt m·ªõi</title>
  <link rel="stylesheet" href="/css/createNews.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>
  <body>
    <header class="news-header">
      <button class="btn-return fas fa-chevron-left fa-lg" onclick="window.location.href='/admin/adminNews'"></button>
      <h1>T·∫°o tin t·ª©c m·ªõi</h1>
    </header>
    <div class="form-wrapper">
      <div class="form-container">
        <form id="createNewsForm" onsubmit="handleFormSubmit(event)">
          <div class="food-form">
            <label for="title">Ti√™u ƒë·ªÅ tin t·ª©c</label>
            <input type="text" id="title" name="title" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ b√†i vi·∫øt" required>

            <label for="description">N·ªôi dung</label>
            <textarea 
              id="description" 
              name="content" 
              placeholder="Nh·∫≠p n·ªôi dung b√†i vi·∫øt"
              rows="6"
              required
            ></textarea>

            <label for="foodImage">·∫¢nh tin t·ª©c</label>
            <input 
              type="file" 
              id="foodImage" 
              name="image" 
              accept="image/*"
              required 
            />

            <button type="submit" class="submit-btn">T·∫°o tin t·ª©c</button>
          </div>
        </form>  
      </div>
    </div>

    <script>
      async function handleFormSubmit(event) {
        event.preventDefault();
        const form = document.getElementById("createNewsForm");
        const formData = new FormData(form);
    
        try {
          const response = await fetch("/admin/adminNews", {
            method: "POST",
            body: formData
          });
    
          const data = await response.json();
    
          if (data.success) {
            Swal.fire({
              title: "Ho√†n t·∫•t!",
              text: "üéâ T·∫°o b√†i vi·∫øt th√†nh c√¥ng",
              icon: "success",
              confirmButtonText: "OK",
            }).then(() => {
              window.location.href = "/admin/adminNews";
            });
          } else {
            Swal.fire({
              title: "L·ªói!",
              text: data.message,
              icon: "error",
              confirmButtonText: "Th·ª≠ l·∫°i",
            });
          }
        } catch (error) {
          Swal.fire({
            title: "L·ªói!",
            text: "C√≥ l·ªói x·∫£y ra khi g·ª≠i d·ªØ li·ªáu.",
            icon: "error",
            confirmButtonText: "Th·ª≠ l·∫°i",
          });
        }
      }
    </script>  
  </body>
</html>
