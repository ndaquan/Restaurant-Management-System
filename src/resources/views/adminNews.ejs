<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Danh s√°ch b√†i vi·∫øt</title>
  <link rel="stylesheet" href="/css/adminNews.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>

<header class="news-header">
  <h1>Danh s√°ch tin t·ª©c</h1>
  <button class="btn-add" onclick="window.location.href='/admin/adminNews/add'">
    <i class="fas fa-plus"></i>
  </button>
</header>

<main class="news-container">
  <% if (newsList && newsList.length > 0) { %>
    <div class="news-list">
      <% newsList.forEach((article) => { %>
        <div class="news-item">
          <div class="news-item-left">
            <img 
              src="<%= article.image %>"
              alt="<%= article.title %>"
            />
          </div>

          <div class="news-item-right">
            <div class="news-top-row">
              <h3 class="news-title">
                <a href="/admin/adminNews/detail/<%= article._id %>">
                  <%= article.title %>
                </a>
              </h3>
            </div>

            <div class="news-middle-row">
              <p class="news-content clamped">
                <%= article.content %>...
              </p>
            </div>

            <div class="news-bottom-row">
              <div class="news-actions">
                <button class="btn-edit" onclick="editNews('<%= article._id %>')">‚úèÔ∏è S·ª≠a</button>
                <button class="btn-delete" onclick="deleteNews('<%= article._id %>')">üóëÔ∏è X√≥a</button>
              </div>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <p>Hi·ªán kh√¥ng c√≥ b√†i vi·∫øt n√†o.</p>
  <% } %>
</main>

<script>
  function editNews(id) {
    window.location.href = '/admin/adminNews/edit/' + id;
  }

  function deleteNews(id) {
    Swal.fire({
      title: 'X√°c nh·∫≠n x√≥a b√†i vi·∫øt',
      text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b√†i vi·∫øt n√†y?',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#3085d6',
      confirmButtonText: 'X√≥a',
      cancelButtonText: 'H·ªßy',
    }).then((result) => {
      if (result.isConfirmed) {
        fetch('/admin/adminNews/' + id, { method: 'DELETE' })
          .then(res => res.json())
          .then(data => {
            Swal.fire('ƒê√£ x√≥a!', 'B√†i vi·∫øt ƒë√£ ƒë∆∞·ª£c x√≥a.', 'success')
              .then(() => {
                window.location.reload();
              });
          })
          .catch(err => console.error(err));
      }
    });
  }
</script>

</body>
</html>
